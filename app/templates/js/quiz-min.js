(function(){var k,l,b=function(e,g){return function(){return e.apply(g,arguments)}};l={how:{"1":"Thought of a number and chose it","2":"Used a die, random number generator, or other random process","3":"Looked around me for a number","4-input":"Mashed the keyboard","4-radio":"Moved the mouse back-and-forth quickly then clicked","4-select":"Moved the mouse back-and-forth quickly then clicked","4-slider":"Moved the slider back-and-forth quickly then released","5":"Other"},why:{"1":"Yes, it is personally significant",
"2":"Yes, it is culturally significant","3":"No, it is arbitrary"}};k=function(){function e(){this.submitFollowup=b(this.submitFollowup,this);this.submit=b(this.submit,this);if(Math.floor(Math.random()*2)===0){this.current_random=true;$("h1 > span").text("Pick a random number from 1 to 10")}else this.current_random=false;$("h1").css("color","");this.number=null;this.active_picker=new (window.pickers[window.picker_options[Math.floor(Math.random()*4)]])($("#methods"));this.active_picker.render();this.els=
{submit_number:$("#submit-number"),submit_followup:$("#submit-followup"),method_container:$("#methods"),methods:$(".method"),followup:$("#follow-up"),done:$("#done")};$(this.active_picker).bind("picked",b(function(){if(this.t_pick==null)this.t_pick=new Date-g;return this.els.submit_number.attr("disabled",false)},this));this.active_picker.type==="slider"&&$(this.active_picker).trigger("picked");this.els.submit_number.click(this.submit);this.els.submit_followup.click(this.submitFollowup);this.els.methods.show();
this.els.method_container.show();g=new Date}var g;g=null;e.prototype.submit=function(){var a;console.log(this.active_picker.number);if(this.t_submit==null)this.t_submit=new Date-g;a={number:this.active_picker.number,method:this.active_picker.type,random:this.current_random,pick:this.t_pick,submit:this.t_submit,range:this.active_picker.range};console.log(a);return $.post("/vote/",a,b(function(c){console.log(c);if(c.status==="success"){this.vote_id=c.vote_id;return this.showFollowup()}},this),"json")};
e.prototype.showFollowup=function(){var a,c,h,i;this.els.methods.hide();$("span.num").text(this.active_picker.number);c=function(d,f,j){if(j==null)j="";return $("<li>"+l[d][f]+j+"</li>")};i=b(function(){var d,f;f=a;d=c("how",""+a);d.click(b(function(){this.followup_how=f;$('input[type="text"]').css("opacity","0.3");$("#how .selected").removeClass("selected");d.addClass("selected");return this.enableSubmitFollowup()},this));return $("#how").append(d)},this);for(a=1;a<=4;a++){if(a===4)a=""+a+"-"+this.active_picker.type;
i()}h=c("how",5,'<input id="follow-up-how-other" type="text" style="opacity:0.3" placeholder="Please describe the method you used.">');h.click(b(function(){$("#follow-up-how-other").keydown(b(function(){return this.followup_how=$("#follow-up-how-other").val()},this));$('input[type="text"]').css("opacity","1");$("#how .selected").removeClass("selected");h.addClass("selected");console.log(this.followup_how);return this.enableSubmitFollowup()},this));$("#how").append(h);i=b(function(){var d,f;f=a;d=
c("why",""+a);d.click(b(function(){this.followup_why=f;$("#why .selected").removeClass("selected");d.addClass("selected");return this.enableSubmitFollowup()},this));return $("#why").append(d)},this);for(a=1;a<=3;a++)i();return this.els.followup.show()};e.prototype.submitFollowup=function(){var a;a={vote_id:this.vote_id,how:""+this.followup_how,why:""+this.followup_why};console.log(a);return $.post("/followup/",a,b(function(c){console.log(c);if(c.status==="success")return this.showDone()},this),"json")};
e.prototype.enableSubmitFollowup=function(){if(this.followup_why!=null&&this.followup_how!=null)return this.els.submit_followup.attr("disabled",false)};e.prototype.showDone=function(){this.els.followup.hide();return this.els.done.show()};return e}();$(document).ready(function(){return new k})}).call(this);
